library(decontam)
library(biomformat)
library(Matrix)
library(dplyr)
library(decontam)
library(biomformat)
library(Matrix)
library(dplyr)
install.packages("devtools")
devtools::install_git("https://forgemia.inra.fr/umrf/ranomaly")
ps <- readRDS(system.file("extdata", "MUClite.rds", package="decontam"))
ps <- readRDS(system.file("extdata", "MUClite.rds"))
ps <- readRDS(system.file("extdata", "MUClite.rds", package="decontam"))
ps <- system.file("extdata", "MUClite.rds", package="decontam"))
ps <- system.file("extdata", "MUClite.rds", package="decontam")
ps <- readRDS(system.file("extdata", "MUClite.rds", package="decontam"))
View(ps)
ps
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "rooted-tree.qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "metadata-Hong3.csv")
physeq<-qza_to_phyloseq("/home/gajender/Documents/R_files/re_analysis/id-filtered-no_mito_no_chlor.qza", "/home/gajender/Documents/R_files/re_analysis/metadata-Hong3.csv")
library(pairwiseAdonis)
library(tidyverse)
library(qiime2R)
library(phyloseq)
library(vegan)
library(RVAideMemoire)
library(pairwiseAdonis)
library(tidyverse)
library(qiime2R)
library(phyloseq)
library(vegan)
library(RVAideMemoire)
library(lme4)
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "metadata-Hong3.csv")
setwd("/home/gajender/Documents/R_files/re_analysis")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "rooted-tree (copy).qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "metadata-Hong3.csv")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "rooted-tree (copy).qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
library("phyloseq"); packageVersion("phyloseq")
physeq<-phyloseq("id-filtered-no_mito_no_chlor.qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-phyloseq("metadata-Hong3.csv")
??decontam
?decontam
physeq<-phyloseq("id-filtered-no_mito_no_chlor.qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-qza_phyloseq("id-filtered-no_mito_no_chlor.qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "taxonomy-HOMD.qza","metadata-Hong3.csv")
physeq<-qza_to_phyloseq("id-filtered-no_mito_no_chlor.qza", "taxonomy-HOMD.qza", "metadata-Hong3.csv")
phyloseq("feature-table.biom", "taxonomy.tsv", "metadata-Hong3.csv")
taxa<-read.csv("taxonomy.tsv", header=T)
taxa<-read.csv("taxonomy.tsv", header=T)
View(taxa)
taxa<-read.csv("taxonomy.tsv", sep= '/t', header=T)
taxa<-read.csv("taxonomy.tsv", sep= "/t", header=T)
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(taxa)
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T)
taxa<-read.table("metadata-Hong3.csv", sep= ",", header=T)
taxa<-read.table("metadata-Hong3.csv", sep= "\t", header=T)
metaMDS()<-read.table("metadata-Hong3.csv", sep= "\t", header=T)
meta<-read.table("metadata-Hong3.csv", sep= "\t", header=T)
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T)
View(meta)
#library(lme4)
physeq<-qza_to_phyloseq("table-dada2.qza", "rooted-tree.qza", "taxonomy-dada2.qza","R-metadata.csv")
taxa<-read.table("feature-table.txt", sep= "\t", header=T)
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T)
View(meta)
View(taxa)
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
View(feature)
physeq<-phyloseq("meta", "taxa","feature")
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.txt", sep= "\t", header=T, row.names = 1)
View(feature)
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.txt", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
View(feature)
physeq<-phyloseq("taxa","feature")
physeq<-phyloseq("meta", "taxa","feature")
physeq<-phyloseq("meta","feature")
physeq<-phyloseq(as.frame("meta", "taxa","feature"))
physeq<-phyloseq(as.data.frame("meta", "taxa","feature"))
physeq<-phyloseq(data.frame("meta", "taxa","feature"))
feature<-read.table(as.data.frame("feature-table.csv", sep= "\t", header=T))
feature<-read.table(as.data.frame("feature-table.csv", sep= "\t", header=T))
feature<-read.table("feature-table.csv", sep= "\t", header=T)
View(feature)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
feature<-read.table("feature-table.csv", sep= "\t", header=T)
meta<-read.table("metadata-Hong.csv", sep= "\t", header=T)
meta<-read.table("metadata-Hong3.csv", sep= "\t", header=T)
View(meta)
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T)
View(taxa)
phyloseq(taxa, meta, feature)
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T)
View(feature)
View(taxa)
phyloseq(taxa, meta, feature)
phyloseq(taxa, feature)
phyloseq()
phyloseq(ja)
phyloseq(taxa)
taxa
phyloseq(taxa)
phyloseq(meta)
feature<-t(read.table("feature-table.csv", sep= "\t", header=T))
View(feature)
feature<-(read.table("feature-table.csv", sep= "\t", header=T))
View(feature)
feature<-t(feature)
View(feature)
feature<-(read.table("feature-table.csv", sep= "\t", header=T, row.names=1))
View(feature)
feature<-t(feature)
View(feature)
phyloseq(taxa, meta, feature)
View(meta)
View(feature)
View(taxa)
feature<-read.table("taxonomy.tsv", sep= "\t", header=T))
taxa<-read.table("taxonomy.tsv", sep= "\t", header=T)
View(taxa)
phyloseq(taxa, meta, feature)
OTU = otu_table(otumat, taxa_are_rows = TRUE)
TAX = tax_table(taxmat)
OTU
otumat = matrix(sample(1:100, 100, replace = TRUE), nrow = 10, ncol = 10)
otumat
rownames(otumat) <- paste0("OTU", 1:nrow(otumat))
colnames(otumat) <- paste0("Sample", 1:ncol(otumat))
otumat
taxmat = matrix(sample(letters, 70, replace = TRUE), nrow = nrow(otumat), ncol = 7)
rownames(taxmat) <- rownames(otumat)
colnames(taxmat) <- c("Domain", "Phylum", "Class", "Order", "Family", "Genus", "Species")
taxmat
library("phyloseq")
OTU = otu_table(otumat, taxa_are_rows = TRUE)
TAX = tax_table(taxmat)
OTU
physeq = phyloseq(OTU, TAX)
physeq
View(taxmat)
contamdf.freq <- isContaminant(physeq, method="frequency", conc="quant_reading")
head(contamdf.freq)
contamdf.freq <- isContaminant(physeq, method="frequency")
View(otumat)
feature<-read.table("taxonomy.tsv", sep= "\t", header=T))
feature<-read.table("taxonomy.tsv", sep= "\t", header=T)
View(feature)
feature<-read.table("taxonomy.tsv", sep= "\t")
View(feature)
feature<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(feature)
taxa=tax_table(taxa)
taxa=tax_table(feature)
View(feature)
feature<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
taxa=tax_table(feature)
colnames(feature) <- c("Domain")
feature
View(feature)
View(meta)
physeq
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(tax)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
View(otu)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
View(sample)
View(sample)
phyloseq(otu,sample,tax)
as(sample_data(sample), "data.frame")
sample=as(sample_data(sample), "data.frame")
sample
phyloseq(otu,sample,tax)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(tax)
TAX
TAX = tax_table(as.matrix(tax))
TAX
OTU
phyloseq(otu,sample,tax)
phyloseq(OTU,sample,TAX)
library(decontam)
ps=phyloseq(OTU,sample,TAX)
ps
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
ps
View(sample)
ps=phyloseq(OTU,sample,TAX)
ps
TAX = sample_data(as.data.frame(sample))
TAX = tax_table(as.matrix(tax))
sample_data= sample_data(as.data.frame(sample))
View(sample_data)
ps=phyloseq(OTU,sampledata,TAX)
sampledata= sample_data(as.data.frame(sample))
View(sampledata)
ps=phyloseq(OTU,sampledata,TAX)
ps
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
sample_data(ps)$is.neg
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
contamdf.prev
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
head(which(contamdf.prev$contaminant))
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
contamdf.prev05
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
> View(tax)
> otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
> View(otu)
> sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
sample_data(ps)$is.neg
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
contamdf.prev
table(contamdf.prev$contaminant)
table(contamdf.prev$contaminant)
OTU
table(contamdf.prev$contaminant)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)OTU = otu_table(otu, taxa_are_rows = TRUE)TAX = tax_table(as.matrix(tax))sampledata= sample_data(as.data.frame(sample))ps=phyloseq(OTU,sampledata,TAX)sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")table(contamdf.prev$contaminant)head(which(contamdf.prev$contaminant))
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
contamdf.prev
View(tax)
View(otu)
ps.pa <- transform_sample_counts(ps, function(abund) 1*(abund>0))
ps.pa.neg <- prune_samples(sample_data(ps.pa)$Sample_or_Control == "Control Sample", ps.pa)
ps.pa
ps.pa.neg
ps.pa.pos <- prune_samples(sample_data(ps.pa)$Sample_or_Control == "True Sample", ps.pa)
ps.pa.pos
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
table(contamdf.prev$contaminant)
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
table(contamdf.prev05$contaminant)
df.pa <- data.frame(pa.pos=taxa_sums(ps.pa.pos), pa.neg=taxa_sums(ps.pa.neg),
contaminant=contamdf.prev$contaminant)
ggplot(data=df.pa, aes(x=pa.neg, y=pa.pos, color=contaminant)) + geom_point() +
xlab("Prevalence (Negative Controls)") + ylab("Prevalence (True Samples)")
df.pa
contamdf.prev05
df <- as.data.frame(sample_data(ps)) # Put sample_data into a ggplot-friendly data.frame
df$LibrarySize <- sample_sums(ps)
df <- df[order(df$LibrarySize),]
df$Index <- seq(nrow(df))
ggplot(data=df, aes(x=Index, y=LibrarySize, color=Sample_or_Control)) + geom_point()
contamdf.freq <- isContaminant(ps, method="frequency", conc="quant_reading")
head(contamdf.freq)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(tax)
View(tax)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
View(tax)
View(otu)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
View(sample)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
View(sampledata)
ps=phyloseq(OTU,sampledata,TAX)
View(sample)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
sample_data(ps)$is.neg
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
contamdf.prev
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
table(contamdf.prev05$contaminant)
write(contamdf.prev05, "test.txt")
View(contamdf.prev)
View(contamdf.prev05)
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
contamdf.prev05
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.6)
contamdf.prev05
View(otu)
table(contamdf.prev05$contaminant)
head(which(contamdf.prev$contaminant))
head(which(contamdf.prev05$contaminant))
write(table(contamdf.prev05$contaminant, "test.txt")
)
write.table(contamdf.prev05, test, append = FALSE, sep = " ", dec = ".",
row.names = TRUE, col.names = TRUE)
write.table(contamdf.prev05, file = "test.txt", sep = "\t",
row.names = TRUE, col.names = NA)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(tax)
OTU = otu_table(otu, taxa_are_rows = TRUE)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
View(tax)
View(sample)
View(otu)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
View(otu)
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
table(contamdf.prev05$contaminant)
contamdf.prev05
contamdf.prev05 <- isContaminant(ps, method="frequency", neg="is.neg", threshold=0.5)
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.1)
contamdf.prev05
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
View(otu)
View(sample)
View(tax)
sampledata= sample_data(as.data.frame(sample))
View(sampledata)
ps=phyloseq(OTU,sampledata,TAX)
ps
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
View(sample)
View(sample)
sample_data(ps)$is.neg
View(tax)
View(tax)
View(otu)
View(sampledata)
View(tax)
View(otu)
View(sample)
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
View(contamdf.prev)
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
ps=phyloseq(OTU,sampledata,TAX, data = as(sample_data(physeq), "data.frame")
)
ps=phyloseq(as.dat.frame((OTU,sampledata,TAX))
ps=phyloseq(as.data.frame((OTU,sampledata,TAX))
ps=phyloseq(as.data.frame(OTU,sampledata,TAX))
View(tax)
View(sampledata)
View(sample)
View("MUClite.rds")
View(contamdf.prev)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
sample<-read.table("metadata-Hong3.csv", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
table(contamdf.prev$contaminant)
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
contamdf.prev05
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.500)
contamdf.prev05
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.51)
contamdf.prev05
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
contamdf.prev05
setwd("/home/gajender/Documents/R_files/re_analysis")
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
ls
pwd
getwd
getwd()
setwd("/home/gajender/Documents/R_files/re_analysis/decontamination/")
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(tax)
otu<-read.table("feature-table.csv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.txt", sep= "\t", header=T, row.names=1)
View(otu)
sample<-read.table("metadata.txt", sep= "\t", header=T, row.names=1)
View(sample)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
sample_names()
sample<-read.table("metadata.txt", sep= "\t", header=T, row.names=1)
View(sample)
otu<-read.table("feature-table.txt", sep= "\t", header=T, row.names=1)
View(otu)
otu<-read_tsv("feature-table.txt", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.txt", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table.txt", sep= "\t", header=T, row.names=1, check.names = FALSE)
OTU = otu_table(otu, taxa_are_rows = TRUE)
ps=phyloseq(OTU,sampledata,TAX)
otu<-read.table("feature-table.txt", sep= "\t", header=T, row.names=1, check.names = FALSE)
OTU = otu_table(otu, taxa_are_rows = TRUE)
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev <- isContaminant(ps, method="prevalence", neg="is.neg")
table(contamdf.prev$contaminant)
head(which(contamdf.prev$contaminant))
contamdf.prev
write.table(contamdf.prev, file = "test.txt", sep = "\t", row.names = TRUE, col.names = NA)
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
write.table(contamdf.prev05, file = "test.txt", sep = "\t", row.names = TRUE, col.names = NA)
table(contamdf.prev05$contaminant)
View(sampledata)
View(contamdf.prev)
View(otu)
View(sample)
tax<-read.table("taxonomy.tsv", sep= "\t", header=T, row.names=1)
View(tax)
otu<-read.table("feature-table2.csv", sep= "\t", header=T, row.names=1)
otu<-read.table("feature-table2.txt", sep= "\t", header=T, row.names=1)
otu
View(otu)
sample<-read.table("metadata2.txt", sep= "\t", header=T, row.names=1)
View(sample)
OTU = otu_table(otu, taxa_are_rows = TRUE)
TAX = tax_table(as.matrix(tax))
sampledata= sample_data(as.data.frame(sample))
ps=phyloseq(OTU,sampledata,TAX)
ps
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
table(contamdf.prev05$contaminant)
head(which(contamdf.prev05$contaminant))
write.table(contamdf.prev05, file = "test.txt", sep = "\t", row.names = TRUE, col.names = NA)
otu<-read.table("99957_feature-table.txt", sep= "\t", header=T, row.names=1)
OTU = otu_table(otu, taxa_are_rows = TRUE)
ps=phyloseq(OTU,sampledata,TAX)
sample_data(ps)$is.neg <- sample_data(ps)$Sample_or_Control == "Control Sample"
contamdf.prev05 <- isContaminant(ps, method="prevalence", neg="is.neg", threshold=0.5)
table(contamdf.prev05$contaminant)
write.table(contamdf.prev05, file = "test.txt", sep = "\t", row.names = TRUE, col.names = NA)
